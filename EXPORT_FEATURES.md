# üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## –û–±–∑–æ—Ä

–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –±–æ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–≥—Ä—É–∑–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel (.xlsx) –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –±–æ—Ç–∞
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"‚¨áÔ∏è –í—ã–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏:
   - **–ó–∞—è–≤–∫–∏** - –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ
   - **–ê—Ä—Ö–∏–≤** - –∞—Ä—Ö–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏ (–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ, –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ)
   - **–û–±—Ä–∞—â–µ–Ω–∏—è** - –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
   - **–û—Ç–∑—ã–≤—ã** - –æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –∑–∞–Ω—è—Ç–∏—è—Ö

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã–≥—Ä—É–∂–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ó–∞—è–≤–∫–∏ (applications_export.xlsx)
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ID | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞—è–≤–∫–∏ |
| TG ID | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –†–æ–¥–∏—Ç–µ–ª—å | –ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è |
| –£—á–µ–Ω–∏–∫ | –ò–º—è —É—á–µ–Ω–∏–∫–∞ |
| –í–æ–∑—Ä–∞—Å—Ç | –í–æ–∑—Ä–∞—Å—Ç —É—á–µ–Ω–∏–∫–∞ |
| –ö–æ–Ω—Ç–∞–∫—Ç | –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| –ö—É—Ä—Å | –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ |
| –î–∞—Ç–∞ —É—Ä–æ–∫–∞ | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —É—Ä–æ–∫–∞ |
| –°—Å—ã–ª–∫–∞ | –°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫ |
| –°—Ç–∞—Ç—É—Å | –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ (–û–∂–∏–¥–∞–µ—Ç/–ù–∞–∑–Ω–∞—á–µ–Ω–æ) |
| –°–æ–∑–¥–∞–Ω–æ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ |

### –ê—Ä—Ö–∏–≤ (archive_export.xlsx)
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ID | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏ |
| TG ID | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –†–æ–¥–∏—Ç–µ–ª—å | –ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è |
| –£—á–µ–Ω–∏–∫ | –ò–º—è —É—á–µ–Ω–∏–∫–∞ |
| –í–æ–∑—Ä–∞—Å—Ç | –í–æ–∑—Ä–∞—Å—Ç —É—á–µ–Ω–∏–∫–∞ |
| –ö–æ–Ω—Ç–∞–∫—Ç | –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| –ö—É—Ä—Å | –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ |
| –î–∞—Ç–∞ —É—Ä–æ–∫–∞ | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —É—Ä–æ–∫–∞ |
| –°—Å—ã–ª–∫–∞ | –°—Å—ã–ª–∫–∞ –Ω–∞ —É—Ä–æ–∫ |
| –°—Ç–∞—Ç—É—Å | –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏ (–ó–∞–≤–µ—Ä—à–µ–Ω–æ/–ó–∞—è–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞/–£—Ä–æ–∫ –æ—Ç–º–µ–Ω—ë–Ω) |
| –°–æ–∑–¥–∞–Ω–æ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ |
| –ö–µ–º –æ—Ç–º–µ–Ω–µ–Ω–æ | –ö—Ç–æ –æ—Ç–º–µ–Ω–∏–ª (user/admin) |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–ø–∏—Å–∏ |

### –û–±—Ä–∞—â–µ–Ω–∏—è (contacts_export.xlsx)
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ID | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±—Ä–∞—â–µ–Ω–∏—è |
| TG ID | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –ö–æ–Ω—Ç–∞–∫—Ç | –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –°–æ–æ–±—â–µ–Ω–∏–µ | –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è |
| –û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∞ | –û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| –°—Ç–∞—Ç—É—Å | –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è |
| –°–æ–∑–¥–∞–Ω–æ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è |
| –û—Ç–≤–µ—Ç –¥–∞–Ω | –î–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞ |
| –ó–∞–±–∞–Ω–µ–Ω | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å |
| –ü—Ä–∏—á–∏–Ω–∞ –±–∞–Ω–∞ | –ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |

### –û—Ç–∑—ã–≤—ã (reviews_export.xlsx)
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| ID | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ç–∑—ã–≤–∞ |
| –†–µ–π—Ç–∏–Ω–≥ | –û—Ü–µ–Ω–∫–∞ –æ—Ç 1 –¥–æ 10 |
| –û—Ç–∑—ã–≤ | –¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞ |
| –ê–Ω–æ–Ω–∏–º–Ω—ã–π | –ê–Ω–æ–Ω–∏–º–Ω—ã–π –ª–∏ –æ—Ç–∑—ã–≤ |
| –†–æ–¥–∏—Ç–µ–ª—å | –ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è |
| –£—á–µ–Ω–∏–∫ | –ò–º—è —É—á–µ–Ω–∏–∫–∞ |
| –ö—É—Ä—Å | –ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ |
| –°–æ–∑–¥–∞–Ω–æ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞ |
| TG ID | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ê–≤—Ç–æ—à–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤** - —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã** - —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–µ—Ä–µ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ** - –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª —Ç–æ–ª—å–∫–æ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- **–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- **–ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## üìà –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```python
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ pandas –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
import pandas as pd

# –ê–Ω–∞–ª–∏–∑ –∑–∞—è–≤–æ–∫
applications_df = pd.read_excel('applications_export.xlsx')
conversion_rate = len(applications_df[applications_df['–°—Ç–∞—Ç—É—Å'] == '–ù–∞–∑–Ω–∞—á–µ–Ω–æ']) / len(applications_df)

# –ê–Ω–∞–ª–∏–∑ –æ—Ç–∑—ã–≤–æ–≤
reviews_df = pd.read_excel('reviews_export.xlsx')
avg_rating = reviews_df['–†–µ–π—Ç–∏–Ω–≥'].mean()
```

### –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
from datetime import datetime

# –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∑–∞—è–≤–∫–∞–º
monthly_applications = applications_df[
    pd.to_datetime(applications_df['–°–æ–∑–¥–∞–Ω–æ']).dt.month == datetime.now().month
]
```

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ –≤—ã–≥—Ä—É–∑–∫–∏

1. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é:
```python
markup.add(types.InlineKeyboardButton("–ù–æ–≤—ã–π —Ç–∏–ø", callback_data="export_new_type"))
```

2. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `handle_export_choice`:
```python
elif call.data == "export_new_type":
    data = get_new_type_data()
    filename = "new_type_export.xlsx"
    headers = ["–ö–æ–ª–æ–Ω–∫–∞ 1", "–ö–æ–ª–æ–Ω–∫–∞ 2", ...]
    rows = data
```

3. –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö callback_data:
```python
func=lambda c: c.data in ["export_applications", "export_archive", "export_contacts", "export_reviews", "export_new_type"]
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–≥—Ä—É–∑–∫–∏ —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `test_export_contacts.py`:

```bash
python test_export_contacts.py
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- ‚úÖ –£—Å–ø–µ—à–Ω—É—é –≤—ã–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –º–µ–Ω—é

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –§–∞–π–ª—ã –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel (.xlsx)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω Telegram API (50 –ú–ë)
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é
- –í—Å–µ –≤—ã–≥—Ä—É–∑–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤—ã–≥—Ä—É–∑–∫–∏ 